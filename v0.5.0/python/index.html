<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Calling from Python · PostNewtonian.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://moble.github.io/PostNewtonian.jl/stable/python/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PostNewtonian.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../pn_expressions/">PN expressions</a></li><li><a class="tocitem" href="../termination_criteria/">Termination criteria</a></li><li><a class="tocitem" href="../utilities/">Utilities</a></li><li><a class="tocitem" href="../gwframes/">GWFrames</a></li><li class="is-active"><a class="tocitem" href>Calling from Python</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Calling from Python</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Calling from Python</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/moble/PostNewtonian.jl/blob/main/docs/src/python.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-this-package-from-Python"><a class="docs-heading-anchor" href="#Using-this-package-from-Python">Using this package from Python</a><a id="Using-this-package-from-Python-1"></a><a class="docs-heading-anchor-permalink" href="#Using-this-package-from-Python" title="Permalink"></a></h1><p>While not quite as natural as calling Python code from Julia, it is very easy to call Julia code from Python.  The process is essentially the same as using any other Python package, other than installing Julia itself and any dependencies <em>within</em> Julia that you may need (both of which are much easier than similar tasks in Python).</p><p>Note that the Julia packages are installed uniquely to your python environment — preferably a conda env.  For example, if you use two different conda envs to call into Julia, you&#39;ll need to install the Julia packages for each env.  This has the great advantage of allowing you to use different packages or versions in each of the different environments.</p><ol><li><p>Install Julia</p><p>The <a href="https://github.com/JuliaLang/juliaup"><code>juliaup</code></a> installer has pretty broad support from some of the main Julia developers, and seems likely to be the main installation method in the not-too-distant future.</p><p>Otherwise, the official method is to just download a binary from the <a href="https://julialang.org/downloads/">official download page</a>.</p><p>Make sure that the <code>julia</code> executable is on your <code>PATH</code>.</p></li><li><p>Optionally, create a conda<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> env just for this task</p><pre><code class="language-bash hljs">conda create -n julia_pn python numpy matplotlib
conda activate julia_pn</code></pre><p>Add whatever other packages you use to that first line.</p></li><li><p>Install <code>juliacall</code> and install <code>PostNewtonian</code></p><pre><code class="language-bash hljs">python -m pip install git+https://github.com/cjdoris/PythonCall.jl.git@1126b561
python -c &#39;from juliacall import Main as jl; jl.seval(&quot;&quot;&quot;using Pkg; Pkg.add(&quot;PostNewtonian&quot;)&quot;&quot;&quot;)&#39;</code></pre><p>(Yes, you should use <code>pip</code> from inside a conda env.)  This will take a few minutes to compile all the necessary packages in Julia.</p></li><li><p>Test the installation</p><p>Start up a python session and run something like this:</p><pre><code class="language-python hljs"># Any python imports you need go here
import numpy as np
import matplotlib.pyplot as plt

# Start the Julia session
from juliacall import Main as jl

# Import `PostNewtonian` in the Julia session
jl.seval(&quot;using PostNewtonian&quot;)

# Declare some parameters
delta = 0.0
chi1 = np.array([0.1, 0.2, 0.3])
chi2 = np.array([-0.2, 0.1, -0.3])
Omega_i = 0.01

# Call into Julia to run some function
w = jl.GWFrames.PNWaveform(&quot;TaylorT1&quot;, delta, chi1, chi2, Omega_i)

# Plot the magnitudes of all the modes as functions of time
plt.semilogy(w.t, np.abs(w.data))</code></pre><p>The last line above uses the <a href="../gwframes/#PostNewtonian.GWFrames.PNWaveform"><code>GWFrames.PNWaveform</code></a> function from this package, which is meant to emulate the original syntax from the <code>GWFrames</code> package.  The resulting <code>w</code> will have various fields, like <code>t</code>, <code>data</code>, and <code>frame</code>, similar to those attached to <code>WaveformModes</code> objects in the <code>scri</code> and <code>sxs</code> packages.</p></li></ol><p>In general, you can now call any Julia function by prepending <code>jl.</code> to the call you would make in Julia.  As a fallback, you can evaluate actual Julia code in the Julia session using <code>jl.seval(&quot;&lt;Julia code goes here&gt;&quot;)</code>.  This returns whatever the Julia code would return.  A simple example is <code>x = jl.seval(&quot;1+2&quot;)</code>.  See the <a href="https://github.com/cjdoris/PythonCall.jl#readme">documentation for <code>juliacall</code> here</a> for more details.</p><p>Typically, the main stumbling block is converting Python lists to Julia <code>Vector</code>s when calling Julia functions.  Frequently, Julia code will have difficulty if you try to pass a Python <code>list</code>, because <code>list</code>s do not have any specific type that Julia can understand.  Instead, you should always convert a list to a numpy array with <code>np.asarray</code>.  It is still possible that numpy will not understand the type of the list, and you&#39;ll still get an error from Julia; in this case you need to figure out <a href="https://numpy.org/doc/stable/reference/generated/numpy.asarray.html">the <code>dtype</code> to tell numpy about.</a>.</p><p>Fortunately, conversion back to Python objects is more automatic.  In particular, if Julia returns a <code>Vector</code>, <code>Matrix</code>, or more generally shaped <code>Array</code>, you can usually just use that quantity in calls to Python functions. If you really need a numpy array, the returned object will have a <code>.to_numpy()</code> method.</p><p>Of course, it is <em>much</em> simpler to call Python code from Julia, so if you find yourself using a lot of Julia code, you may want to consider flipping your approach.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>As general advice, you should <code>conda install -y mamba</code> in your &quot;base&quot;   conda env, and then just use the command <code>mamba</code> wherever you would have   used <code>conda</code>; <code>mamba</code> is a complete drop-in replacement, but is much   faster because it&#39;s written in C instead of python.  For example, <code>mamba   create -n julia_pn python numpy matplotlib</code> will typically run faster   than the command given here.  This becomes a huge advantage when the env   has lots of dependencies.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gwframes/">« GWFrames</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.21 on <span class="colophon-date" title="Wednesday 27 July 2022 18:04">Wednesday 27 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
