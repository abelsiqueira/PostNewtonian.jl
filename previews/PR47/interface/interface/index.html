<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>High-level functions · PostNewtonian.jl</title><meta name="title" content="High-level functions · PostNewtonian.jl"/><meta property="og:title" content="High-level functions · PostNewtonian.jl"/><meta property="twitter:title" content="High-level functions · PostNewtonian.jl"/><meta name="description" content="Documentation for PostNewtonian.jl."/><meta property="og:description" content="Documentation for PostNewtonian.jl."/><meta property="twitter:description" content="Documentation for PostNewtonian.jl."/><meta property="og:url" content="https://moble.github.io/PostNewtonian.jl/stable/interface/interface/"/><meta property="twitter:url" content="https://moble.github.io/PostNewtonian.jl/stable/interface/interface/"/><link rel="canonical" href="https://moble.github.io/PostNewtonian.jl/stable/interface/interface/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PostNewtonian.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Interface</span><ul><li><a class="tocitem" href="../high-level/">High-level interface</a></li><li><a class="tocitem" href="../units/">Units</a></li><li><a class="tocitem" href="../symbolics/">Symbolic manipulations</a></li><li><a class="tocitem" href="../differentiation/">Automatic differentiation</a></li><li><a class="tocitem" href="../assorted_binaries/">Assorted binaries</a></li><li><a class="tocitem" href="../python/">Python</a></li><li><a class="tocitem" href="../gwframes/">GWFrames</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../../internals/code_structure/">Code structure</a></li><li><a class="tocitem" href="../../internals/systems/">PN systems</a></li><li><a class="tocitem" href="../../internals/fundamental_variables/">Fundamental variables</a></li><li><a class="tocitem" href="../../internals/derived_variables/">Derived variables</a></li><li><a class="tocitem" href="../../internals/pn_expressions/">PN expressions</a></li><li><a class="tocitem" href="../../internals/dynamics/">Dynamics</a></li><li><a class="tocitem" href="../../internals/waveforms/">Waveforms</a></li><li><a class="tocitem" href="../../internals/utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../adding_terms/">Adding terms</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>High-level functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>High-level functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl/blob/main/docs/src/interface/interface.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="High-level-functions"><a class="docs-heading-anchor" href="#High-level-functions">High-level functions</a><a id="High-level-functions-1"></a><a class="docs-heading-anchor-permalink" href="#High-level-functions" title="Permalink"></a></h1><p>Most users will just want to evaluate the PN orbital evolution and/or the waveform.  Though these were both touched on briefly in the &quot;<a href="../../#Quick-start">Quick start</a>&quot; section and are extensively documented in their corresponding docstrings, we highlight some of the more useful features here.</p><h2 id="Orbital-evolution"><a class="docs-heading-anchor" href="#Orbital-evolution">Orbital evolution</a><a id="Orbital-evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Orbital-evolution" title="Permalink"></a></h2><p>A post-Newtonian inspiral is computed by the <a href="../../internals/dynamics/#PostNewtonian.orbital_evolution"><code>orbital_evolution</code></a> function.</p><h3 id="Orbital_evolution_Input_arguments"><a class="docs-heading-anchor" href="#Orbital_evolution_Input_arguments">Input arguments</a><a id="Orbital_evolution_Input_arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Orbital_evolution_Input_arguments" title="Permalink"></a></h3><h4 id="Time-steps"><a class="docs-heading-anchor" href="#Time-steps">Time steps</a><a id="Time-steps-1"></a><a class="docs-heading-anchor-permalink" href="#Time-steps" title="Permalink"></a></h4><p>The default output contains just the times to which the ODE integrator stepped, which can be <em>very</em> coarsely sampled.  In particular, if you evaluate the inertial-frame waveform on these time steps, it will almost surely be sampled far below the Nyquist limit, which will generally render the waveform useless.</p><p>There are three useful approaches to deal with this:</p><ol><li>Do nothing on input, but interpolate the <em>output</em> inspiral object to some desired time steps using its built-in interpolation capabilities.  This uses the &quot;dense output&quot; results of the ODE integrator, which produces very efficient and accurate results.  This is a very good option if the following two are not applicable, especially if you need to know the PN evolution before you can decide on the time steps you want.  See the <a href="#Orbital_evolution_Output">&quot;Output&quot;</a> section below for details.</li><li>If you want to ensure that each orbit is sampled a certain number of times, you can pass the <code>saves_per_orbit</code> option to <code>orbital_evolution</code>.</li><li>If you want the results with some fixed uniform time step <code>dt</code>, you can just pass the option <code>saveat=dt</code> to <code>orbital_evolution</code>.</li><li>If you happen to know specific times <code>t</code> at which you want the result, you can pass the option <code>saveat=t</code> to <code>orbital_evolution</code>.  This may be relevant, for example, when comparing the PN waveform to an existing waveform.  Note that the inspiral <em>may</em> end earlier than your last <code>t</code> value, in which case the output will just be shorter than requested.</li></ol><h4 id="When-to-stop"><a class="docs-heading-anchor" href="#When-to-stop">When to stop</a><a id="When-to-stop-1"></a><a class="docs-heading-anchor-permalink" href="#When-to-stop" title="Permalink"></a></h4><p>Once the equations have been entered correctly, the hardest part about PN orbital evolution is deciding when to stop.  We know that PN approximations fail somewhere below <span>$v=1$</span>.  In practice, especially at higher orders, the equations <em>frequently</em> for <span>$v \approx 0.5$</span>, and can fail as early as <span>$v \approx 0.4$</span>.  The breakdown point typically depends on many factors, such as the masses and spins of the binary, the PN order at which expressions are truncated, and the approximant used to integrate the orbit.</p><p>But wherever this breakdown lies, as the ODE integrator approaches the breakdown, it works harder to maintain accurate evolution of the equations it has been given — even though <em>the equations themselves</em> are no longer trustworthy.  In fact, a majority of the ODE integrator&#39;s time may be spent trying to evolve the last fraction of an orbit as the integrator takes smaller and smaller time steps to maintain accuracy in a regime where we shouldn&#39;t believe PN itself.  Loosening the <code>abstol</code> and/or <code>reltol</code> requirements would make the rest of the inspiral less accurate, but still wouldn&#39;t improve this situation very much.</p><p>Ideally, you should pick some frequency below the default value (which corresponds to <span>$v=1$</span>) to let the ODE integration stop before it gets too close to the breakdown point.  You can pass this lower value as the <code>Ωₑ</code> argument to <code>orbital_evolution</code>.  For example, a value corresponding to <span>$v=0.3$</span> would be unlikely to run into problems — except perhaps in very obscure corners of parameter space.</p><h3 id="Orbital_evolution_Output"><a class="docs-heading-anchor" href="#Orbital_evolution_Output">Output</a><a id="Orbital_evolution_Output-1"></a><a class="docs-heading-anchor-permalink" href="#Orbital_evolution_Output" title="Permalink"></a></h3><p><code>inspiral</code></p><ul><li>inspiral.t</li><li>inspiral[:, j]</li><li>inspiral[i, j]</li><li>inspiral[i, :]</li><li>inspiral(t′)</li><li>inspiral(t′, Val{1})  # Up to Val{4}</li><li>inspiral(t′, Val{1}, idxs=[:M₁, :M₂])</li><li>inspiral[:v]</li><li>inspiral[[:v, :Φ], :] Note that there is no translation for this in Python (because of Unicode and because of the Symbol syntax), but we can use the following from Python:</li><li>PNVariable.(inspiral.u)</li></ul><h2 id="Waveform"><a class="docs-heading-anchor" href="#Waveform">Waveform</a><a id="Waveform-1"></a><a class="docs-heading-anchor-permalink" href="#Waveform" title="Permalink"></a></h2><p><code>coorbital_waveform</code> / <code>inertial_waveform</code></p><h3 id="Waveform_Input_arguments"><a class="docs-heading-anchor" href="#Waveform_Input_arguments">Input arguments</a><a id="Waveform_Input_arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Waveform_Input_arguments" title="Permalink"></a></h3><h3 id="Waveform_Output"><a class="docs-heading-anchor" href="#Waveform_Output">Output</a><a id="Waveform_Output-1"></a><a class="docs-heading-anchor-permalink" href="#Waveform_Output" title="Permalink"></a></h3></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 26 June 2024 20:04">Wednesday 26 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
