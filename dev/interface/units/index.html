<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Units · PostNewtonian.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://moble.github.io/PostNewtonian.jl/stable/interface/units/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PostNewtonian.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Interface</span><ul><li><a class="tocitem" href="../high-level/">High-level interface</a></li><li class="is-active"><a class="tocitem" href>Units</a><ul class="internal"><li><a class="tocitem" href="#Example-1:-Scale-dependence"><span>Example 1: Scale dependence</span></a></li><li><a class="tocitem" href="#Units-example-2"><span>Example 2: Astrophysical units</span></a></li></ul></li><li><a class="tocitem" href="../symbolics/">Symbolic manipulations</a></li><li><a class="tocitem" href="../differentiation/">Automatic differentiation</a></li><li><a class="tocitem" href="../assorted_binaries/">Assorted binaries</a></li><li><a class="tocitem" href="../python/">Python</a></li><li><a class="tocitem" href="../gwframes/">GWFrames</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../../internals/code_structure/">Code structure</a></li><li><a class="tocitem" href="../../internals/systems/">PN systems</a></li><li><a class="tocitem" href="../../internals/fundamental_variables/">Fundamental variables</a></li><li><a class="tocitem" href="../../internals/derived_variables/">Derived variables</a></li><li><a class="tocitem" href="../../internals/pn_expressions/">PN expressions</a></li><li><a class="tocitem" href="../../internals/dynamics/">Dynamics</a></li><li><a class="tocitem" href="../../internals/waveforms/">Waveforms</a></li><li><a class="tocitem" href="../../internals/utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../adding_terms/">Adding terms</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Interface</a></li><li class="is-active"><a href>Units</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Units</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/moble/PostNewtonian.jl/blob/main/docs/src/interface/units.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="A-note-about-units"><a class="docs-heading-anchor" href="#A-note-about-units">A note about units</a><a id="A-note-about-units-1"></a><a class="docs-heading-anchor-permalink" href="#A-note-about-units" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">TL;DR:</header><div class="admonition-body"><p>This package uses geometric units with <span>$G=c=1$</span>.  Units are essentially determined by the values you input.  Masses and frequencies in particular must have inverse units.  For example, if frequency is measured in Hertz, mass should be measured in seconds.  The common relativist&#39;s convention of measuring in units of &quot;total mass&quot; (whatever that means to you) is also perfectly fine.</p><p>Output time is in units of the total mass; to get the time in seconds, multiply by the total mass as measured in seconds.  Waveforms are output as the asymptotic quantity <span>$rh/M$</span>; to get an observable strain, multiply by the total mass and divide by the distance to the source.</p><p>You may want to skip to <a href="#Units-example-2">Example 2</a> for a complete example using astrophysical units.</p></div></div><p>The units of measurement used in this package are implicitly established by the input.  Specifically, the arguments <code>M₁</code>, <code>M₂</code>, and <code>Ωᵢ</code> in the call</p><pre><code class="language-julia hljs">inspiral = orbital_evolution(M₁, M₂, χ⃗₁, χ⃗₂, Ωᵢ)</code></pre><p>are inherently dimensionful, and the units are effectively determined by the values entered.  For example, if we enter <code>0.4</code> as <code>M₁</code>, we have established the units as — quite simply — those units in which <code>M₁</code> has the value <code>0.4</code>.  The only real requirement on the units of the input arguments is that they must be consistent.  In particular, the quantity <code>(M₁+M₂)*Ωᵢ</code> should be dimensionless.</p><p>It must also be noted that this package uses geometric units where <span>$G=c=1$</span>; in fact, <span>$G$</span> and <span>$c$</span> never appear in the code at all.  This means that you must input values in geometric units, and interpret the output as being in geometric units.  This does not completely constrain the units, however.  There is still a freedom to scale the units however you wish.  For example, it is most common to describe all quantities in units of some mass <span>$M$</span> — such as the sum of the input masses <code>M₁+M₂</code> or the Solar mass <span>$M_\odot$</span>.  The input arguments would then be given in units of that mass.</p><p>The complete set of (required or optional) dimensionful arguments to <code>orbital_evolution</code> is</p><pre><code class="language-julia hljs">M₁, M₂, Ωᵢ, λ₁, λ₂, Ω₁, Ωₑ, abstol, saveat</code></pre><p>If we scale the values by some <code>σ</code>, then to maintain the same physical meaning we should transform all the arguments as</p><pre><code class="nohighlight hljs">M₁ ↦ M₁ * σ
M₂ ↦ M₂ * σ
Ωᵢ ↦ Ωᵢ / σ
λ₁ ↦ λ₁ * σ^5
λ₂ ↦ λ₂ * σ^5
Ω₁ ↦ Ω₁ / σ
Ωₑ ↦ Ωₑ / σ
abstol ↦ [abstol[1:2] * σ; abstol[3:end]]
saveat ↦ saveat * σ</code></pre><p>Note that the scaling happens automatically for default values of the parameters; you would only need to rescale them if you were actually setting them.</p><p>When the scaled arguments are provided to <code>orbital_evolution</code>, the resulting <code>inspiral</code> is affected as</p><pre><code class="language-julia hljs">inspiral.t ↦ inspiral.t * σ
inspiral[:M₁] ↦ inspiral[:M₁] * σ
inspiral[:M₂] ↦ inspiral[:M₂] * σ</code></pre><p>All other evolved variables are dimensionless, and so are unaffected by the scaling.</p><p>The waveform <span>$H$</span> returned by either <a href="../../internals/waveforms/#PostNewtonian.coorbital_waveform"><code>coorbital_waveform</code></a> or <a href="../../internals/waveforms/#PostNewtonian.inertial_waveform"><code>inertial_waveform</code></a> is the rescaled asymptotic limit of the strain.  The observable strain is</p><p class="math-container">\[h \approx H\, \frac{M}{r}\, \frac{G}{c^2}
\qquad \mathrm{or} \qquad
h \approx H\, \frac{M_z}{d_\mathrm{L}}\, \frac{G}{c^2}.\]</p><p>Here, <span>$r$</span> is the radius of the observer in asymptotically Minkowski coordinates centered on the source and <span>$M$</span> is the total mass of the binary; alternatively, <span>$M_z=M(1+z)$</span> is the redshifted mass and <span>$d_\mathrm{L}$</span> is the luminosity distance between the source and observer.  For more complete description, see <a href="../../internals/waveforms/#Computing-the-waveform">here</a>.</p><h2 id="Example-1:-Scale-dependence"><a class="docs-heading-anchor" href="#Example-1:-Scale-dependence">Example 1: Scale dependence</a><a id="Example-1:-Scale-dependence-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1:-Scale-dependence" title="Permalink"></a></h2><p>It&#39;s important to check that the claims above are actually true.  Here, we put them to the test with a very large scale factor.</p><pre><code class="language-julia hljs">σ = 10^10  # Scale factor

M₁ = 0.4
M₂ = 0.6
χ⃗₁ = [0.0, 0.5, 0.8]
χ⃗₂ = [0.8, 0.0, 0.5]
Ωᵢ = 0.01
Ω₁ = 3Ωᵢ/4
Ωₑ = 0.9
dt = 5

inspiral1 = orbital_evolution(M₁, M₂, χ⃗₁, χ⃗₂, Ωᵢ, Ω₁=Ω₁, Ωₑ=Ωₑ, saveat=dt)
inspiral2 = orbital_evolution(M₁*σ, M₂*σ, χ⃗₁, χ⃗₂, Ωᵢ/σ, Ω₁=Ω₁/σ, Ωₑ=Ωₑ/σ, saveat=dt*σ)

plot(inspiral1.t, inspiral1[:v], label=&quot;Original&quot;)
plot!(inspiral2.t/σ, inspiral2[:v], label=&quot;Scaled&quot;, linewidth=4, ls=:dot)
plot!(xlabel=&quot;Time&quot;, ylabel=&quot;PN parameter 𝑣&quot;)

# Check that the evolved `v` parameters are nearly equal (when interpolating
# the second to *exactly* the same times as the first)
inspiral1[:v] ≈ inspiral2(inspiral1.t*σ, idxs=:v)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><iframe src="units1.html" style="height:500px;width:100%;"></iframe><p>The fact that these curves are on top of each other, and the final expression returned <code>true</code> shows that this system does indeed depend on scale as suggested above.</p><h2 id="Units-example-2"><a class="docs-heading-anchor" href="#Units-example-2">Example 2: Astrophysical units</a><a id="Units-example-2-1"></a><a class="docs-heading-anchor-permalink" href="#Units-example-2" title="Permalink"></a></h2><p>Suppose we want to construct a system consistent with <a href="https://arxiv.org/abs/1606.01210">GW150914</a>, having masses <span>$35.6\,M_\odot$</span> and <span>$30.0\,M_\odot$</span>, as it would be observed from a distance of <span>$440\,\mathrm{Mpc}$</span> with an initial frequency in the <span>$(\ell,m)=(2,2)$</span> mode of <span>$f_i \approx 20\,\mathrm{Hz}$</span>.</p><p>Because the masses and frequencies must be in inverse units, we arbitrarily choose to measure frequencies in their natural unit of Hertz, and therefore masses are measured in seconds — multiplying the masses by <span>$G/c^3$</span> for geometric units.  The distance to the source <span>$d_\mathrm{L}$</span> will also be converted to seconds by dividing by <span>$c$</span>, so that we can simply multiply the waveform by <span>$M_z/d_\mathrm{L}$</span> to get the observed strain.</p><p>The frequency <span>$f_i$</span> is the observed initial frequency of the <span>$(2,2)$</span> mode. We will need the corresponding angular orbital frequency in the frame.  The two are related by</p><p class="math-container">\[\Omega_i = \frac{2\pi f_i}{2(1+z)}.\]</p><pre><code class="language-julia hljs">using Quaternionic
using SphericalFunctions
using PostNewtonian
using Plots

# Useful astronomical constants
c = float(299_792_458)   # meters/second
GMₛᵤₙ = 1.32712440041e20  # meters³/second²
au = float(149_597_870_700)  # meters
pc = 1au / (π / 648_000)  # meters
Mpc = 1_000_000pc  # meters

# Approximate maximum a posteriori spins
χ⃗₁ = [0.0, 0.0, 0.3224]
χ⃗₂ = [0.2663, 0.2134, -0.5761]

# Parameters of this system
M₁ = 35.6GMₛᵤₙ / c^3  # seconds
M₂ = 30.0GMₛᵤₙ / c^3  # seconds
dL = 440Mpc / c  # seconds
z = 0.094
Mz = (M₁+M₂) * (1+z)  # seconds
fᵢ = 20  # Hertz
Ωᵢ = 2π * fᵢ / 2(1+z)  # Hertz
dt = 1/2048(1+z)  # seconds — Observer&#39;s sampling interval in the source frame

inspiral = orbital_evolution(M₁, M₂, χ⃗₁, χ⃗₂, Ωᵢ, saveat=dt)
tobs = (1+z)*inspiral.t
Hₗₘ = inertial_waveform(inspiral)
hₗₘ = Hₗₘ * Mz / dL

# Evaluate waveform at a point; see Scri.jl for simpler methods
R = Quaternionic.from_spherical_coordinates(2.856, 0.0)
₋₂Yₗₘ = SphericalFunctions.ₛ𝐘(-2, 8, Float64, [R])[1, :]
h = (₋₂Yₗₘ&#39; * hₗₘ)[1,:]

plot(tobs, real.(h), label=&quot;ℎ₊&quot;)
plot!(tobs, -imag.(h), label=&quot;ℎₓ&quot;)
plot!(xlabel=&quot;Time (seconds)&quot;, ylabel=&quot;Strain (dimensionless)&quot;, ylim=(-1.5e-21,1.5e-21))</code></pre><iframe src="units2.html" style="height:500px;width:100%;"></iframe></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../high-level/">« High-level interface</a><a class="docs-footer-nextpage" href="../symbolics/">Symbolic manipulations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 6 April 2023 20:44">Thursday 6 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
